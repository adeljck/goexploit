package sunlogin

import (
	"fmt"
	"goexploit/common"
	"net"
	"strconv"
	"time"
)

func scanPort(addr string, port string) {
	defer common.Args.WG.Done()
	common.Args.CH <- 0
	_, err := net.DialTimeout("tcp", addr+":"+port, time.Duration(common.Args.TimeOut)*time.Second)
	<-common.Args.CH
	if err != nil {
		return
	}
	fmt.Printf("port %s is open with tcp protocol\n", port)
}
func Scan(target string, portLow int, portHigh int) {
	for i := portLow; i < portHigh; i++ {
		common.Args.WG.Add(1)
		go scanPort(target, strconv.Itoa(i))
	}
	common.Args.WG.Wait()
}
